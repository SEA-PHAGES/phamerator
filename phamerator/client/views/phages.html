<template name="phages">

    {{> mapSettingsModal}}
      {{#if newFeature}}
        {{> featureDiscovery}}
      {{/if}}

    <div id="geneData" class="modal">
        <h5>{{selectedGeneTitle}}</h5>
        <ul class="tabs tabs-fixed-width" style="overflow-x: hidden">
            <li class="tab col s3"><a href="#dna-seq">DNA</a></li>
            <li class="tab col s3"><a href="#protein-seq">Protein</a></li>
            <li class="tab col s3"><a href="#domains">Domains</a></li>
            <li class="tab col s3"><a href="#pham-clusters">Clusters</a></li>
            <li class="tab col s3"><a href="#notes">Function</a></li>
        </ul>

        <div id="dna-seq">
            <div class="modal-content">
              <span class='sequence'><p id="gene_dna_seq" class='sequence'>{{selectedGene}}</p></span>
            </div>
            <div class="modal-footer">
                <button id="copy-dna-button" class="waves-effect waves-green btn-flat btn-copy-link" data-clipboard-target="#gene_dna_seq">Copy to Clipboard</button>
                <a href="phages" class=" modal-action modal-close waves-effect waves-green btn-flat">Close</a>
            </div>
        </div>

        <div id="protein-seq">
            <div class="modal-content">
              <span class='sequence'><p id="gene_protein_seq" class='sequence'>{{selectedProtein}}</p></span>
            </div>
            <div class="modal-footer">
                <button id="copy-protein-button" class="waves-effect waves-green btn-flat btn-copy-link" data-clipboard-target="#gene_protein_seq">Copy to Clipboard</button>
                <a href="phages" class=" modal-action modal-close waves-effect waves-green btn-flat">Close</a>
            </div>
        </div>

        <div id="domains">
        <div class="modal-content">
        <svg id= svgDomain></svg>
        <ul class="collapsible" data-collapsible="expandable">
        {{ #each domain in selectedDomains}}
            <li id= {{domain.domainname}}>
                <div class="collapsible-header" id={{domain.domainname}}>{{domain.domainname}}</div>
                <div class="collapsible-body" id={{domain.domainname}}>
                    <ul>
                      <li>
                      <a href={{domain.domainLink}} target="_blank"><i class="material-icons">insert_link</i></a>
                    </li>
                        <li>
                            {{domain.description}}

                        </li>
                        <br/>
                        <li><u>
                            Protein Alignment Data:
                        </u></li>
                        <li>
                            Query Start (Amino Acid Position): {{domain.query_start}}
                        </li>
                        <li>
                            Query End (Amino Acid Position): {{domain.query_end}}
                        </li>
                        <li>
                            E-Value: {{domain.expect}}
                        </li>
                    </ul>
                </div>
            </li>

        {{/each}}
        </ul>
        </div>
            <div class="modal-footer">
                <a href="phages" class=" modal-action modal-close waves-effect waves-green btn-flat">Close</a>
            </div>
        </div>

        <div id="pham-clusters">
            <div class="modal-content">
                <ul class="collapsible" data-collapsible="expandable">
                {{ #each c in selectedClusters}}
                    <li>
                        <div class="collapsible-header">{{c.cluster}}</div>
                        <div class="collapsible-body">
                            <ul>
                                {{#each p in c.phages}}
                                    <li>{{p}}</li>
                                {{/each}}
                            </ul>
                        </div>
                    </li>

                {{/each}}
                </ul>
            </div>
            <div class="modal-footer">
                <a href="phages" class=" modal-action modal-close waves-effect waves-green btn-flat">Close</a>
            </div>
        </div>
        <div>
            <div class="modal-content">
                <!--<span id="gene_dna_seq" style="font-family: monospace; width:90%; word-wrap:break-word; display:inline-block;">{{selectedGene}}</span>-->
                <p id="notes">{{selectedGeneNotes}}</p>
            </div>
            <div class="modal-footer">
                <a href="phages" class=" modal-action modal-close waves-effect waves-green btn-flat">Close</a>
            </div>
        </div>

    </div>


    <div class="row">

        <div class="col s12">
            <!--<div class="progress">
                <div class="determinate" style="width: 0%"></div>
            </div>-->
                <ul class="tabs white tabs-fixed-width" style="overflow-x: hidden">
                    <li class="tab col s6 m6 l6"><a class="active black-text" href="#phages-list">Select Phages</a></li>
                    <li class="tab col s6 m6 l6"><a id="viewMapTab" class="black-text" href="#genome-map">Draw Map</a></li>
                </ul>
        </div>

        <div id="phages-list" class="col s12">
            <!--<a id="clearSelection" class="waves-effect waves-light btn">Clear Selection</a>-->
            <ul id="cluster-list" class="collapsible">
            <!--{{#transition in="fadeIn" out="fadeOut"}}-->
                {{#each clusters}}
                    <!--{{> cluster canRender=canRender}}-->
                    {{> cluster}}
                {{/each}}
            <!--{{/transition}}-->

            </ul>

            <div class="fixed-action-btn" style="bottom: 45px; right: 24px;">
                <a id="menu" class="btn-floating btn-large waves-effect waves-light">
                    <i class="material-icons">menu</i>
                </a>
                <ul>
                    <li><a id="scroll_top" class="btn-floating orange ">
                        <i class="material-icons left">arrow_upward</i>up
                    </a></li>
                        <li><a id="collapse_all" class="btn-floating light-blue darken-1">
                            <i class="material-icons left">remove</i>remove
                        </a></li>
                        <li><a id="expand_all" class="btn-floating light-blue ">
                            <i class="material-icons left">add</i>search
                        </a></li>
                    <!--{{#if genomes_are_selected}}-->
                        <li><a id="clearPhageSelection" class="btn-floating purple">
                            <i class="material-icons left">clear</i>Clear Selection
                        </a></li>
                    <!--{{/if}}-->
                </ul>
            </div>
        </div>

        <div id="genome-map" class="col s12">
            <svg id="svg-genome-map"></svg>
            <div class="fixed-action-btn horizontal" style="bottom: 45px; right: 24px;">
                <a id="menu2" class="waves-effect waves-light btn-floating btn-large">
                    <i class="material-icons">menu</i>
                </a>
                <ul>
                    <li>
                        <button class="downloadGenomeMap waves-effect waves-yellow btn-floating purple">
                            <i class="material-icons left">system_update_alt</i>Export Genome Map
                        </button>
                    </li>
                    <li>
                        <button class="mapSettings waves-effect waves-purple btn-floating yellow">
                            <i class="material-icons left">settings</i>Settings
                        </button>
                    </li>
                    <!--
                    <li>
                        <button data-target="mapsettings" class="btn modal-trigger settings waves-effect waves-purple btn-floating yellow">
                            <i class="material-icons left">settings</i>Genome Map Settings
                        </button>
                    </li>-->
                </ul>
            </div>


        </div>
    </div>
</template>

<template name="cluster">
  <li>
      <div class="collapsible-header">
        <label for="cluster-{{name}}">
          <input type="checkbox" id="cluster-{{name}}" data-cluster="{{cluster}}" data-subcluster="{{subcluster}}" class="filled-in clusterCheckbox" checked="{{clusterIsChecked cluster subcluster}}" />
          <span>{{name}}</span>
        </label>

        <span class="{{selectedClass cluster subcluster}}" data-badge-caption="{{dataBadgeCaption cluster subcluster}}">{{selectedCount cluster subcluster}}</span>
      </div>
      <div class="collapsible-body">
              <ul class="clusterSelector">
                  {{#each p in phageNames}}
                    <li class="phageSelector">
                      <label for="{{p}}">
                        <input type="checkbox" id="{{p}}" class="filled-in phageCheckbox" checked="{{phageIsChecked p}}"/>
                        <span>{{p}}</span>
                      </label>
                    </li>
                  {{/each}}
              </ul>
      </div>
  </li>
</template>
